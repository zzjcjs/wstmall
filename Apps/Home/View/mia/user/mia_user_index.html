<extend name="./Apps/Home/View/mia/mia_base.html"/>
<link rel="stylesheet" href="http://file01.miyabaobei.com/resources/styles/main.css?v=20151117" type="text/css">
<link rel="stylesheet" href="http://file01.miyabaobei.com/resources/styles/add.css?v=151124" type="text/css">
<link rel="stylesheet" href="http://file01.miyabaobei.com/resources/styles/account/account.css?v=3" type="text/css">
<block name="body">
<div class="warp">
    <div class="content detail">
        <div class="w1004">
            <div class="h20" > </div>
            <div class="ic clearfix">
                <div class="left l">
                    <div class="title">我的交易</div>
                    <ul>
                        <li >
                            <a href="/order">我的订单</a>
                        </li>
                        <li >
                            <a href="/return_lists">退货退款</a>
                        </li>
                    </ul>
                    <div class="title">我的收藏</div>
                    <ul>
                        <li >
                            <a href="/my_brand">我收藏的品牌</a>
                        </li>
                        <li ><a href="/my_collect">我收藏的商品</a></li>
                    </ul>
                    <div class="title">我的分享</div>
                    <ul>
                        <li >
                            <a href="/my_invite">我邀请的朋友</a></li>
                        <li >
                            <a href="/my_koubei.html">商品口碑</a></li>
                    </ul>
                    <div class="title">我的优惠</div>
                    <ul>
                        <li >
                            <a href="/my_jifen.html">积分管理</a>
                        </li>
                        <li >
                            <a href="/my_coupon">代金券管理</a>
                        </li>
                        <li >
                            <a href="/my_getredbag">红包管理</a>
                        </li>
                        <li  style="text-indent:12px;">
                            <a href="/my_getredbag">我的红包</a>
                        </li>
                        <li  style="text-indent:12px;">
                            <a href="/my_shareredbag">分享红包</a>
                        </li>
                    </ul>
                    <div class="title">我的账户</div>
                    <ul>
                        <li >
                            <a href="/my_profile.html">账户信息</a>
                        </li>
                        <li >
                            <a href="/my_balance.html">账户余额</a>
                        </li>
                        <li >
                            <a href="/my_idstatus.html">实名认证</a>
                        </li>
                        <li >
                            <a href="/my_password.html">修改密码</a>
                        </li>
                        <li >
                            <a href="/my_address.html">地址管理</a>
                        </li>
                        <li >
                            <a href="/my_message.html">蜜芽消息</a>
                        </li>
                    </ul>
                </div>
                <div class="right l">
                    <div class="icmain clearfix">
                        <div class="photo l">
                            <img src="http://file01.miyabaobei.com/resources/images/icon_none.gif" alt="默认头像" width="120"/>
                            <a href="/home/profile/icon/?refer=home">修改头像</a></div>
                        <div class="intro l">
                            <div class="tit01">{$WST_USER["loginName"]}, 欢迎您! </div>
                            <p>会员等级：宝宝帝&emsp;&emsp;<a href="/help/9" target="_blank" class="gray">会员级别介绍</a><br/>
                                当前积分：<span class="pink">0</span>&emsp;&emsp;<a href="/help/10" target="_blank" class="gray">积分获取规则</a> </p>
                            <div class="iline"></div>
                            <p> 累计消费金额：
                                <span class="pink">&yen; 0.00</span><br/>
                            <div class="iline"></div>
            <span id="accountStatus">
                <span class="verify">
                                        手机已验证
                                    </span>
                <span class="verify">
                                        邮箱未验证 <a href="/my_emailverify" class="gray">去验证&gt;&gt;</a>&nbsp;&nbsp;[送50蜜豆]
                                    </span>
                <span class="verify">
                                        未实名认证 <a href="/my_identification.html" class="gray">去验证>></a>
                                    </span>
            </span>
                            </p>
                        </div>
                    </div>                    <link rel="stylesheet" href="http://file01.miyabaobei.com/resources/styles/account/account.css?v=3" type="text/css">
                    <style type="text/css">
                        .changeAddressBtn{margin-right: 2px;display: inline-block;font-size: 12px;height: 18px;line-height: 18px;padding: 3px 6px;text-align: center;color: #000;text-decoration: none;border-radius: 3px;border: 1px solid #e393bb;}
                        .orderListHead span a:hover{color:#000;}

                        .changeAddress{width:360px;height:425px;background-color:#fff;border:4px solid #a9a9a7;font-size:12px;overflow:auto;display: none;display: none;z-index: 111001;position: absolute;left: 50%;top: 50%;margin-left: -180px;margin-top: -212px;position: fixed!important;}
                        .changeAddTit{height:31px;background-color:#f7f7f7;border-bottom:1px solid #eaeaea;color:#666666;line-height: 31px;font-weight: bold;position: relative;padding-left:14px;}
                        .changeAddTit img{position:absolute;right:12px;top:6px;cursor:pointer;}
                        .changeAddress .changeAddh3{color:#999999;line-height:31px;padding-left:14px;margin-top:11px;}
                        .changeAddmake{width:330px;border:1px solid #eaeaea;background-color:#fcfcfc;margin:0 auto;margin-bottom:13px;position: relative;}
                        .changeAddmake ul{padding-top:14px;padding-left:13px;padding-right:54px;}
                        .changeAddmake ul li{color:#a9a9a7;list-style-type: none;line-height:20px;}
                        .changeAddmake ul li.changeSecondLi{margin-bottom:8px;}
                        .changeAddmake a{color:#f450a2;font-weight: bold;text-decoration:underline;position: absolute;top:36px;right:15px;}
                        .changeSecondH3{margin-top:8px;}
                        .changeSecondBox{background-color:#fff;cursor:pointer;position: relative;}
                        .changeSecondBox ul{padding-right:54px;}
                        .changeSecondBox img{position:absolute;right:0px;bottom: 0px;display: none;}    /* 选择增加的img */
                        .changeSecondBox ul li{color:#666666;}
                        .changeSecondBox ul li.changeFirstLi{color:#333333;}

                        .changeAddressForm{width:598px;border:4px solid #a9a9a7;font-size:12px;background-color:#fff;display: none;z-index: 111001;position: absolute;left: 50%;top: 50%;margin-left: -299px;margin-top: -139px;position: fixed!important;}
                        .changeAddUl{margin-top:21px;padding-left: 0px;color:#999999;line-height:31px;padding-left:26px;}
                        .changeAddUl ul li{list-style-type: none;margin-bottom:12px;float: left;margin-right:21px;}
                        .changeAddUl ul li input{margin-left:10px;border:1px solid #cccccc;color:#333333;padding-left: 4px;}
                        .changeAddUl .goodsMan{padding-left:13px;width:517px;}
                        #changeAddUl_but1{width:126px;height:24px;line-height: 24px;}
                        #changeAddUl_but2 label{padding-right:5px;}
                        #changeAddUl_but2 .select1{width:132px;height:17px;}
                        #changeAddUl_but2 .select2{width:79px;height:17px;}
                        #changeAddUl_but2 .select3{width:79px;height:17px;}
                        #changeAddUl_but2 .select4{width:119px;height:17px;}
                        #changeAddUl_but3{width:356px;height:24px;color:#333333;line-height: 24px;}
                        #changeAddUl_but4{width:194px;height:24px;color:#333333;line-height: 24px;}
                        #changeAddUl_but5{width:194px;height:24px;color:#333333;line-height: 24px;}
                        .changeAddressForm .Operation{margin-left: 63px;}
                        .Operation{margin:0 auto;clear: both;color:#fff;font-size: 14px;font-weight: bold;text-align: center;width:225px;line-height: 30px;}
                        .Operation .Determine{width:104px;height:30px;background-color:#f450a2;float: left;margin-right:17px;cursor: pointer;margin-bottom: 15px;}  /* 确定 */
                        .Operation .Cancel{width:104px;height:30px;background-color:#f450a2;float: left;cursor: pointer;margin-bottom: 15px;}  /* 取消*/

                        .changeAddressCon{width:367px;border:4px solid #a9a9a7;font-size:12px;background-color:#fff;display: none;z-index: 111001;position: absolute;left: 50%;top: 50%;margin-left: -183px;margin-top: -98px;position: fixed!important;}
                        .changeAddressCon .changeAddh3{color:#f450a2;font-weight: bold;line-height:31px;padding-left:20px;margin-top:8px;}
                        .changeAddressCon p{color:#666666;line-height:24px;padding-left:20px;padding-right:20px;}
                        .changeAddressCon .Operation{padding-top: 11px;}
                        .Operation .Determine.change_sur{background-color:#ff69b3;font-weight:normal;}
                        .Operation .Cancel.change_qx{background-color:#f9f9f9;color:#000000;font-weight:normal;border:1px solid #d5d5d5;width: 102px;height:28px;}


                        .changeAddressSF{width:367px;height:196px;border:4px solid #a9a9a7;font-size:12px;background-color:#fff;display: none;z-index: 111001;position: absolute;left: 50%;top: 50%;margin-left: -183px;margin-top: -98px;position: fixed!important;}
                        .changeAddZt{width:299px;height:60px;margin:0 auto;margin-top:14px;font-size:14px;}
                        .changeAddZt img{vertical-align: middle;margin-right:9px;color:#333333;font-size: 14px;}
                        .changeAddressSucD{width:100px;height:30px;background-color:#f450a2;cursor: pointer;line-height: 30px;color:#fff;font-size: 14px;font-weight: bold;text-align: center;margin:0 auto;margin-top:20px;}


                        /*遮罩*/
                        .popup_mask{display:none;width:100%;height: 100%;z-index: 111000;position: fixed;top:0;left:0;  background-color: #000;
                            filter:alpha(opacity=50);/*IE*/opacity:0.5;/*FF*/position:fixed!important;/*FF IE7*/position:absolute;/*IE6*/}
                        .popup_notice{display: none;z-index: 111001;height: 423px;position: absolute;left:50%;top:50%;margin-left: -260px;margin-top: -211px;position:fixed!important;/*FF IE7*/positiabsolute;/*IE6*/}
                        .popup_notice a#close_mia_popup{display: block;position: absolute;width: 50px;height: 50px;top:14px;right:12px;background:url(about:blank)}

                        /* 新增 */
                        .add_messages {
                            vertical-align: middle;
                            color: #F67649;
                            width:148px;
                            height:22px;
                            border: 1px solid #FEDBB1;
                            background: #FFFDE7;
                            margin: 15px 0 16px 0px;
                            padding: 0px 4px;
                            font-size: 12px;
                            font-family: Verdana, Geneva, sans-serif;
                            line-height: 22px;
                            font-weight: normal;
                        }
                    </style>
                    <div class="splist p20" id="orderList">
                        您还没有订单        <!-- 修改地址显示弹框 -->
                        <div class="changeAddress">
                            <div class="changeAddTit">修改地址<img src="resources/images/close.jpg"></div>       <!-- header -->
                            <div class="changeAddh3">修改订单收货地址</div>
                            <div class="changeAddmake addr1">
                                <ul>
                                    <li></li>
                                    <li class="changeSecondLi"></li>
                                </ul>
                                <a href="#" class="changeAddress_xg xgnew">修改</a>
                            </div>

                            <div class="changeAddh3 changeSecondH3">选择已有收货地址</div>
                            <!-- address list -->
                            <!-- end address list -->
                        </div>
                        <!-- 修改需要修改的弹框 -->
                        <div class="changeAddressForm">
                            <div class="changeAddTit">修改地址<img src="resources/images/close.jpg"></div>       <!-- header -->
                            <div class="changeAddUl">
                                <ul>
                                    <li class="goodsMan">收货人:<input type="text" value="" id='changeAddUl_but1' class="name"/></li>
                                    <li id='changeAddUl_but2'>
                                        <!--  <form action="" method="get">
                                          <label>所在地区:</label>
                                          <select name="" class="select1 province" onchange="change_province($(this),'province')">
                                              <option value="0">请选择</option>
                                          </select>
                                          <select name="" class="select2 city" onchange="change_province($(this),'city')">
                                              <option value="0">请选择</option>
                                          </select>
                                          <select name="" class="select3 area" onchange="change_province($(this),'area')">
                                                  <option value="0">请选择</option>
                                          </select>
                                          <select name="" class="select4 street">
                                              <option value="0">请选择</option>
                                          </select>
                                          </form> -->

                                        <tbody>
                                        <tr>
                                            <td align="right"><span class="pink"></span> 所在地区：</td>
                                            <td id="address_area">
                        <span id="span_province">
                        	<select id="ship_province" name="ship_province" class="province" onchange="change_province($(this),'province')">
                                <option value="0">请选择</option>
                            </select>
                        </span>
                        <span id="span_city">
	                        <select id="ship_city" name="ship_city" class="city" onchange="change_province($(this),'city')">
                                <option value="0">请选择</option>
                            </select>
                        </span>
                        <span id="span_area">
                        	<select id="ship_area" name="ship_area" class="area" onchange="change_province($(this),'area')">
                                <option value="0">请选择</option>
                            </select>
                        </span>
                        <span id="span_town">
                        <select id="ship_town" name="ship_town" class="street">
                            <option value="0">请选择</option>
                        </select></span>
                                                <span id="new_area_error"></span>
                                            </td>
                                        </tr>
                                        </tbody>

                                    </li>
                                    <li>详细地址:<input type="text" value=""  id='changeAddUl_but3' class="address"/></li>
                                    <li>手机号码:<input type="text" value=""  id='changeAddUl_but4' class="cell"/></li>
                                    <li>固定电话:<input type="text" value=""  id='changeAddUl_but5' class="phone"/></li>
                                </ul>

                                <div class="Operation">
                                    <div class="add_messages" style="display: none"></div>
                                    <div class="Determine">确定</div>
                                    <div class="Cancel">取消</div>
                                </div>
                            </div>
                        </div>
                        <!-- 修改地址确认弹框 -->
                        <div class="changeAddressCon">
                            <div class="changeAddTit">修改地址确认<img src="resources/images/close.jpg"></div>       <!-- header -->
                            <div class="changeAddh3">修改后地址如下</div>
                            <p id='newAddress'></p>
                            <div class="Operation">
                                <div class="Determine change_sur">确定</div>
                                <div class="Cancel change_qx">取消</div>
                            </div>
                        </div>
                        <!-- 修改地址成功弹框 -->
                        <div class="changeAddressSF changeAddressCG">
                            <div class="changeAddTit">修改地址成功<img src="resources/images/close.jpg"></div>       <!-- header -->
                            <div class="changeAddZt"><img src="resources/images/cg.jpg" />您的地址已经修改成功！</div>
                            <div class="changeAddressSucD">确定</div>
                        </div>
                        <!-- 修改地址失败弹框 -->
                        <div class="changeAddressSF changeAddressSB">
                            <div class="changeAddTit">修改地址失败<img src="resources/images/close.jpg"></div>       <!-- header -->
                            <div class="changeAddZt"><img src="resources/images/shb.jpg" /><span class="msg"></span></div>
                            <div class="changeAddressSucD">确定</div>
                        </div>
                        <!-- 遮罩 -->
                        <div id="mia_popup_mask" class="popup_mask" style="display: none;"></div>
                        <script>
                            var provinceJsonList = {};
                            var orderAddrInfo = {};

                            function change_province(obj,name){

                                var selectId = obj.val();
                                var ele = $('.changeAddressForm');

                                switch(name){
                                    case 'province':
                                        ele.find('.city option[value!="0"]').remove();
                                        ele.find('.area option[value!="0"]').remove();
                                        ele.find('.street option[value!="0"]').remove();

                                        getAddrJsonList({act:'get_cities_json',
                                            data:{province_id:selectId},
                                            'assign_ele' : ele.find('.city'),
                                        });

                                        break;
                                    case 'city':
                                        ele.find('.area option[value!="0"]').remove();
                                        ele.find('.street option[value!="0"]').remove();
                                        getAddrJsonList({act:'get_areas_json',
                                            data:{city_id:selectId},
                                            'assign_ele' : ele.find('.area'),
                                        });

                                        break;
                                    case 'area':
                                        ele.find('.street option[value!="0"]').remove();
                                        getAddrJsonList({act:'get_towns_json',
                                            data:{area_id:selectId},
                                            'assign_ele' : ele.find('.street'),
                                        });
                                        break;
                                }
                            }

                            function getAddrJsonList(argData){
                                //argData.act = get_cities_json
                                var selectId = false;

                                $.ajax({
                                    url:'/instant/order/' + argData.act,
                                    type:'post',
                                    data:argData.data,
                                    //async:false,
                                    dataType:'json',
                                    success:function(res){
                                        var plen = res.length;
                                        var pstr = '';
                                        for(var i = 0; i< plen; i++){
                                            var select = '';
                                            if(selectId === false){
                                                select = res[i].name == argData.selectName ? ' selected="selected"' : '';
                                                if(select != '')selectId = res[i].id;
                                            }
                                            pstr += '<option value="'+res[i].id+'" '+ ( select ) +'>'+res[i].name+'</option>';
                                        }
                                        argData.assign_ele.find('option[value!="0"]').remove();
                                        argData.assign_ele.append(pstr);
                                        if(selectId){
                                            if(argData.act == 'get_cities_json'){
                                                assign_addr_list(selectId,'city');
                                            }else if(argData.act == 'get_areas_json'){
                                                assign_addr_list(selectId,'area');
                                            }
                                        }
                                    }
                                });

                                return selectId;

                            }

                            function getAddrList(obj){
                                var par_code = obj.attr('data-oc');
                                $.ajax({
                                    url:'/instant/order/getEditOrderAddressList',
                                    type:'post',
                                    data:{'par_code':par_code},
                                    dataType:'json',
                                    success:function(res){
                                        $('#mia_popup_mask').show();

                                        var ele = $('.changeAddress');
                                        ele.find('.changeSecondBox').remove();
                                        ele.find('.changeSecondH3').hide();
                                        if(!res.code){
                                            tip_fail(res.msg);
                                            obj.parent().remove();
                                            return false;
                                        }
                                        ele.show();
                                        ele.find('.changeSecondH3').show();
                                        provinceJsonList = res.province_json;
                                        orderAddrInfo = res.orderAddrInfo;

                                        ele.find('.addr1 li').eq(0).html(res.orderAddrInfo.name +' '+ res.orderAddrInfo.cell);
                                        ele.find('.addr1 .changeSecondLi').html(res.orderAddrInfo.province + res.orderAddrInfo.city + res.orderAddrInfo.area + res.orderAddrInfo.street + res.orderAddrInfo.address);
                                        ele.find('.xgnew').attr('data-oc', par_code);
                                        var str = '';
                                        var len = res.addressList.length;
                                        if(len){
                                            for(var i = 0; i < len; i++){
                                                str += '<div class="changeAddmake changeSecondBox">';
                                                str += '<ul>';
                                                str += '<li class="changeFirstLi">'+res.addressList[i].name+'  '+res.addressList[i].cell+'</li>';
                                                str += '<li class="changeSecondLi">'+ (res.addressList[i].is_default == 1 ? '[默认]' : '')+ res.addressList[i].provname + res.addressList[i].cityname+ res.addressList[i].areaname+ res.addressList[i].townname+ res.addressList[i].address + '</li>';
                                                str += '<a href="#" class="changeAddress_xg xgodd" order_code="'+par_code+'" data-addrId="'+res.addressList[i].id+'">选择</a>';
                                                str += '</ul>';
                                                str += '</div>';

                                            }
                                            if(str){
                                                $('.changeAddress .changeSecondBox').remove();
                                                $(str).insertAfter($('.changeAddress .changeSecondH3'));
                                            }

                                        }



                                    }
                                });

                            }

                            function check_form(){
                                var prev_ele = $('.changeAddressForm');
                                var data = {};
                                var ret = {msg:'',pass:true, 'data': {}};
                                data.name = prev_ele.find('.name').val();
                                data.province = prev_ele.find('.province option:selected').text();
                                data.province_id = prev_ele.find('.province option:selected').val();
                                data.city = prev_ele.find('.city option:selected').text();
                                data.city_id = prev_ele.find('.city option:selected').val();
                                data.area = prev_ele.find('.area option:selected').text();
                                data.area_id = prev_ele.find('.area option:selected').val();
                                data.street = prev_ele.find('.street option:selected').text();
                                data.street_id = prev_ele.find('.street option:selected').val();
                                data.address = prev_ele.find('#changeAddUl_but3').val();

                                data.cell = prev_ele.find('.cell').val();
                                data.phone = prev_ele.find('.phone').val();

                                for(var f in data){
                                    if(!ret.pass)break;
                                    var v = data[f];
                                    switch(f){
                                        case 'name':
                                            if(isEmpty(v)){
                                                ret.msg = '收货人不能为空';
                                                ret.pass = false;
                                            }else if(!is_forbid(v)){
                                                ret.msg = '收货人中含有非法字符';
                                                ret.pass = false;
                                            }else if(v.length > 25){
                                                ret.msg = '收货人姓名不能大于25位';
                                                ret.pass = false;
                                            }
                                            break;
                                        case 'province':
                                            if(!data.province_id || parseInt(data.province_id) <= 0 || isEmpty(v)){
                                                ret.msg = '请选择所在省';
                                                ret.pass = false;
                                            }
                                            break;
                                        case 'city':
                                            if(!data.city_id || parseInt(data.city_id) <= 0 || isEmpty(v)){
                                                ret.msg = '请选择所在市';
                                                ret.pass = false;
                                            }
                                            break;
                                        case 'area':
                                            if(!data.area_id || parseInt(data.area_id) <= 0 || isEmpty(v)){
                                                ret.msg = '请选择所在区';
                                                ret.pass = false;
                                            }
                                            break;
                                        case 'street':
                                            if(!data.street_id || parseInt(data.street_id) <= 0 || isEmpty(v)){
                                                ret.msg = '请完善所在地区';
                                                ret.pass = false;
                                            }
                                            break;

                                        case 'address':
                                            if(isEmpty(v)){
                                                ret.msg = '详细地址不能为空';
                                                ret.pass = false;
                                            }else if(!is_forbid(v)){
                                                ret.msg = '详细地址中含有非法字符';
                                                ret.pass = false;
                                            }else if(v.length>50){
                                                ret.msg = '详细地址中过长';
                                                ret.pass = false;
                                            }
                                            break;

                                        case 'cell':
                                            if(isEmpty(v)){
                                                ret.msg = '手机号码不能为空';
                                                ret.pass = false;
                                            }else if(!check_mobile(v)){
                                                ret.msg = '手机号码格式不正确';
                                                ret.pass = false;
                                            }
                                            break;

                                        case 'phone':
                                            if(!isEmpty(v)){
                                                if(!is_forbid(v)){
                                                    ret.msg = '固定电话中含有非法字符';
                                                    ret.pass = false;
                                                }
                                                else if(!checkPhone(v)){
                                                    ret.msg = '"固定电话号码格式不正确';
                                                    ret.pass = false;
                                                }
                                            }
                                            break;

                                    }
                                }
                                ret.data = data;
                                return ret;
                            }

                            function submitAddr(){

                                var prev_ele = $('.changeAddressForm');
                                var con = $('.changeAddressCon');
                                var data = {};
                                if(con.attr('from') == 'edit'){
                                    var ck = check_form();
                                    if(!ck.pass){
                                        alert(ck.msg);
                                        return false;
                                    }

                                    /*data.province = prev_ele.find('.province option:selected').text();
                                     data.city = prev_ele.find('.city option:selected').text();
                                     data.area = prev_ele.find('.area option:selected').text();
                                     data.street = prev_ele.find('.street option:selected').text();
                                     data.address = prev_ele.find('#changeAddUl_but3').val();
                                     data.name = prev_ele.find('.name').val();
                                     data.cell = prev_ele.find('.cell').val();
                                     data.phone = prev_ele.find('.phone').val();
                                     */
                                    data.province = ck.data.province;
                                    data.city = ck.data.city;
                                    data.area = ck.data.area;
                                    data.street = ck.data.street;
                                    data.address = ck.data.address;
                                    data.name = ck.data.name;
                                    data.cell = ck.data.cell;
                                    data.phone = ck.data.phone;

                                    data.order_code = prev_ele.attr('order_code');
                                }else{
                                    data.address_id = con.attr('addrid');
                                    data.order_code = con.attr('order_code');
                                }


                                $.ajax({
                                    url:'/instant/order/change_order_addr',
                                    type:'post',
                                    data:data,
                                    //data:{'newAddrInfo':data,'order_code' : order_code},
                                    dataType:'json',
                                    success:function(res){
                                        if(res.status){                         //成功
                                            $('.changeAddressCon').hide();
                                            $('.changeAddressCG').show();
                                        }else{                             //失败
                                            $('.changeAddressCon').hide();
                                            tip_fail(res.msg);
                                        }

                                    }
                                });


                            }

                            function tip_fail(msg){
                                $('.changeAddressSB .msg').text(msg);
                                $('.changeAddressSB').show();
                            }


                            function showEdit(order_code){
                                var ele = $('.changeAddressForm');
                                ele.attr('order_code',order_code);
                                ele.find('.name').val(orderAddrInfo.name);
                                ele.find('.address').val(orderAddrInfo.address);
                                ele.find('.cell').val(orderAddrInfo.cell);
                                ele.find('.phone').val(orderAddrInfo.phone);
                                ele.find('.province option[value!="0"]').remove();
                                var plen = provinceJsonList.length;
                                var pstr = '';
                                var selectPro = false;
                                var	selectCity = false;
                                var selectArea = false;
                                for(var i = 0; i< plen; i++){
                                    var select = '';
                                    if(selectPro === false){
                                        select = provinceJsonList[i].name == orderAddrInfo.province ? ' selected="selected"' : '';
                                        if(select != ''){
                                            selectPro = provinceJsonList[i].id;
                                        }
                                    }
                                    pstr += '<option value="'+provinceJsonList[i].id+'"'+ ( select ) +'>'+provinceJsonList[i].name+'</option>';
                                }

                                ele.find('.province').append(pstr);
                                return selectPro;
                                if(selectPro){
                                    /*var cityId = getAddrJsonList({act:'get_cities_json',
                                     data:{province_id:selectPro},
                                     'assign_ele' : ele.find('.city'),
                                     'selectName' : orderAddrInfo.city
                                     });

                                     var areaId = getAddrJsonList({act:'get_areas_json',
                                     data:{city_id:cityId},
                                     'assign_ele' : ele.find('.area'),
                                     'selectName' : orderAddrInfo.area
                                     });

                                     getAddrJsonList({act:'get_towns_json',
                                     data:{area_id:areaId},
                                     'assign_ele' : ele.find('.street'),
                                     'selectName' : orderAddrInfo.street
                                     }); */

                                }
                            }

                            function assign_addr_list(id,from){

                                var ele = $('.changeAddressForm');
                                var select_id = 0;
                                switch(from){
                                    case 'province':
                                        select_id = getAddrJsonList({act:'get_cities_json',
                                            data:{province_id:id},
                                            'assign_ele' : ele.find('.city'),
                                            'selectName' : orderAddrInfo.city
                                        });
                                        //assign_addr_list(select_id,'city');
                                        break;

                                    case 'city':
                                        select_id = getAddrJsonList({act:'get_areas_json',
                                            data:{city_id:id},
                                            'assign_ele' : ele.find('.area'),
                                            'selectName' : orderAddrInfo.area
                                        });
                                        //assign_addr_list(select_id,'area');
                                        break;

                                    case 'area':
                                        getAddrJsonList({act:'get_towns_json',
                                            data:{area_id:id},
                                            'assign_ele' : ele.find('.street'),
                                            'selectName' : orderAddrInfo.street
                                        });

                                        break;
                                }
                                return select_id;
                            }


                            (function(){

                                function changeAddress(){
                                    this.changeAddressBtn='.changeAddressBtn';  //弹出层1
                                    this.closes='.changeAddTit img,.Operation .Cancel';
                                    this.xgnew='.xgnew'; //修改
                                    this.xgodd='.xgodd'; //选择
                                    this.Determine='.changeAddressForm .Determine';  //修改地址下的确定
                                    this.changeAddressCon='.changeAddressCon .Determine';    //点修改地址确认的确定
                                    this.changeAddressSF='.changeAddressSF .changeAddressSucD';   //最后取消
                                }
                                changeAddress.prototype={
                                    AddressBtn:function(){
                                        $(this.changeAddressBtn).click(function(){ //弹出层1
                                            $('.changeAddress .changeSecondBox').remove();
                                            getAddrList($(this));
                                            // $('#mia_popup_mask').show();
                                            // $('.changeAddress').show();

                                        })
                                        $(this.closes).click(function(){    //弹出层1关闭  //弹出层所有的取消按钮
                                            $('#mia_popup_mask').hide();
                                            $('.changeAddress').hide();
                                            $('.changeAddressForm').hide();
                                            $('.changeAddressCon').hide();
                                            $('.changeAddressCG').hide();
                                            $('.changeAddressSB').hide();
                                        })
                                        $(this.xgnew).click(function(){   //点修改

                                            $('.changeAddress').hide();
                                            $('.changeAddressForm').show();
                                            var select_id = showEdit($(this).attr('data-oc')); //edit
                                            assign_addr_list(select_id,'province');
                                        })
                                        $('.changeAddress').delegate('.xgodd','click',function(){   //点选择
                                            $('.changeAddress').hide();
                                            $('.changeAddressCon').show();
                                            $('.changeAddressCon').attr('from','select');
                                            $('.changeAddressCon').attr('order_code',  $(this).attr('order_code'));
                                            $('.changeAddressCon').attr('addrId', $(this).attr('data-addrId'));
                                            $('#newAddress').text($(this).siblings('.changeSecondLi').text()+' '+$(this).siblings('.changeFirstLi').text());
                                        })
                                        $(this.Determine).click(function(){   //点修改地址下的确定

                                            var result = check_form();
                                            if(!result.pass){
                                                var tipEle = $(this).prev('.add_messages');
                                                tipEle.text(result.msg).fadeIn();
                                                setTimeout(function(){
                                                    $('.changeAddressForm .add_messages').text('').fadeOut();
                                                },2000);
                                                return false;
                                            }

                                            $('.changeAddressForm').hide();
                                            $('.changeAddressCon').show();
                                            $('.changeAddressCon').attr('order_code', $('.changeAddressForm').attr('order_code'));
                                            $('.changeAddressCon').attr('from','edit');
                                            //修改html
                                            var str ='';
                                            var prev_ele = $('.changeAddressForm');
                                            str += prev_ele.find('.province option:selected').text();
                                            str += prev_ele.find('.city option:selected').text();
                                            str += prev_ele.find('.area option:selected').text();
                                            str += prev_ele.find('.street option:selected').text();
                                            str += prev_ele.find('#changeAddUl_but3').val();
                                            str += ' ' + prev_ele.find('.name').val();
                                            str += ' ' + prev_ele.find('.cell').val();
                                            str += ' ' + prev_ele.find('.phone').val();
                                            $('#newAddress').text(str);
                                        })
                                        //点修改地址确认的确定   可能显示成功也可能显示失败
                                        $(this.changeAddressCon).click(function(){

                                            //提交修改后的地址
                                            submitAddr();

                                            /*   if(true){                         //成功
                                             $('.changeAddressCon').hide();
                                             $('.changeAddressCG').show();
                                             }else{                             //失败
                                             $('.changeAddressCon').hide();
                                             $('.changeAddressSB').show();
                                             } */
                                        })
                                        //最后的点击取消
                                        $(this.changeAddressSF).click(function(){
                                            $('#mia_popup_mask').hide();
                                            $('.changeAddressSF').hide();
                                        })
                                    }
                                }
                                new changeAddress().AddressBtn()
                            })()


                        </script>                    <div class="more tr">
                        <a href="/order_lists.html" class="pink">查看更多&gt;&gt;</a>
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="rfrim">
    <div class="rightFunction dn">
        <div class="OnlineCS NFBpub service_mia_0">
            <div class="hide_button" style="position:absolute;top:0; left:0; width: 65px; height: 46px; z-index: 9;"></div>
            <a href="javascript:void(0)" class="cur NFBpub">在线咨询</a>
            <!-- online chat 开始-->
            <div style='display:none;'>
                <a href='http://www.live800.com'>在线聊天</a>
                <script type="text/JavaScript" language="javascript">
                    var live_c = getcookie('live_info');
                    if(live_c) {
                        document.write("<scr"+"ipt language=\"javascript\" src=\"http://chat800.mia.com/live800/chatClient/staticButton.js?companyID=424726&configID=7&codeType=custom&info=" + getcookie('live_info') + "\" charset=\"UTF-8\"></scr"+"ipt>");
                    } else {
                        document.write("<scr"+"ipt language=\"javascript\" src=\"http://chat800.mia.com/live800/chatClient/staticButton.js?companyID=424726&configID=7&codeType=custom\" charset=\"UTF-8\"></scr"+"ipt>");
                    }
                </script>
                <div style='display:none;'>
                    <a href='http://en.live800.com'>live chat</a>
                </div>

                <!--online chat 结束-->
                <!-- online chat 默认跟踪代码: 开始-->
                <script language="javascript" src="http://chat800.mia.com/live800/chatClient/monitor.js?companyID=424726&configID=3&codeType=custom"></script>
                <!-- online chat 默认跟踪代码: 结束-->
            </div>
        </div>
        <div class="CustomerPhone NFBpub"> <a href="javascript:void(0);" class="cur NFBpub">客服电话</a>
            <div class="phone400 NFBpub pop">400-789-2000</div>
        </div>
        <div class="Mobilephone NFBpub"> <a href="javascript:void(0);" class="cur NFBpub">手机逛蜜芽</a>
            <div class="phoneewm NFBpub pop">400-789-2000</div>
        </div>
        <div class="ShoppingCart NFBpub"> <a href="/cart" class="cur NFBpub">购物车</a>
            <div class="Nnum" id="rightFunctionCartNum" style="display:none;">0</div>
            <!--        <div class="Nnum" id="rightFunctionCartNum">0</div>-->
        </div>
        <div class="Ngotop NFBpub"> <a href="javascript:void(0)" class="cur NFBpub">返回顶部</a> </div>
    </div>
</div>
<!--last change by ou,lzj @ 20151014-->
<div class="leftExtension dn" >
    <!--
    <a href="/event/send_coupon" target="_blank" class="topImage xxx" style="display:none;"><img src="http://file01.miyabaobei.com/resources/images/index_left_wx3Dc.png?v=20150710" /></a>
    -->
    <div class="LEwx"></div>
</div>
<style>
    .leftExtension { bottom:443px; /*bottom:290px;*/}
</style>
</block>